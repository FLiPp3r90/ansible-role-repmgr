---
# Versions
postgres_release: "{{ postgresql_version | default(12) }}"

# Os user
postgres_user: postgres
postgres_group: postgres

# Postgres vars
repmgr_postgres_admin_user: 'postgres'
repmgr_postgres_admin_user_group: 'postgres'
postgres_ssh_dir: "{{ postgres_home_dir }}/.ssh"
postgres_ssh_rsa_key: "{{ postgres_ssh_dir }}/id_rsa"
postgres_data_directory: "{{ postgresql_data_directory | default('{{ postgres_home_dir }}/{{ postgres_release }}/data') }}"
postgres_conf_directory: "{{ postgresql_conf_directory | default('/etc/postgresql/{{ postgres_release }}/data') }}"

# Repmgr repository
repmgr_install_repository: true

# Systemd services
## repmgr-cluster-scripts service
## Used to handle reboot of the cluster by cloning from available node.
## To lighten source decision, use a Virtual IP or use /etc/hosts.
repmgr_cluster_scripts_replication_source: "cluster.my.company.example.com"
## Set autostart
repmgr_cluster_scripts_enabled: false


## Legacy services from packages
## Set autostart
postgres_service_enabled: true
repmgr_repmgrd_service_enabled: true


# Repmgr vars
repmgr_conf_file: 'repmgr.conf'
repmgr_user: 'repmgr'
repmgr_dbname: 'repmgr'

# Repmgr config options
repmgr_conninfo: "host={{ ansible_hostname }} user={{repmgr_postgres_user}} dbname={{ repmgr_dbname }} connect_timeout=2"
repmgr_node_id: '1'
repmgr_failover: 'automatic'
repmgr_loglevel: 'INFO'
repmgr_logfacility: 'STDERR'
repmgr_log_file: '/var/log/repmgr/repmgr.log'
repmgr_wal_receive_check_timeout: 1

# Repmgr commands
repmgr_promote_command: "{{ repmgr_bin_dir }}/repmgr standby promote -f {{ repmgr_conf_dir }}/repmgr.conf --log-to-file"
repmgr_follow_command: "{{ repmgr_bin_dir }}/repmgr standby follow -f {{ repmgr_conf_dir }}/repmgr.conf --log-to-file"

# Role management
repmgr_always_promote: false
repmgr_is_master: false
repmgr_register_master: false
repmgr_register_standby: false
repmgr_clone_standby: false
repmgr_bootstrap: false
repmgr_install_only: true
repmgr_install_postgresql: false
